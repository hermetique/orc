include "benchmark.inc"

def fibNaive(Integer) :: Integer
def fibNaive(0) = 0
def fibNaive(1) = 1
def fibNaive(n) = fibNaive(n-1) + fibNaive(n-2)

def fibPair(Integer) :: Integer
def fibPair(n) = 
  def fib(Integer) :: (Integer, Integer)
  def fib(0) = (0, 0)
  def fib(1) = (1, 0)
  def fib(n) = 
    val (f1, f2) = fib(n-1) #
    (f1 + f2, f1)
  fib(n)(0)  

def fibPairTailrec(Integer) :: Integer
def fibPairTailrec(n) = 
  def fib(Integer, Integer, Integer) :: Integer
  def fib(i, curr, _) if (i = n) = curr
  def fib(i, curr, prev) = fib(i+1, curr + prev, curr)
  fib(0, 0, 1)

benchmark({

fibPairTailrec(3000) >x> Println(x) >> stop

;

fibPairTailrec(1000) >x> Println(x) >> stop

;

fibPair(1000) >x> Println(x) >> stop

;

fibNaive(19) >x> Println(x) >> stop
})

{-
OUTPUT:
410615886307971260333568378719267105220125108637369252408885430926905584274113403731330491660850044560830036835706942274588569362145476502674373045446852160486606292497360503469773453733196887405847255290082049086907512622059054542195889758031109222670849274793859539133318371244795543147611073276240066737934085191731810993201706776838934766764778739502174470268627820918553842225858306408301661862900358266857238210235802504351951472997919676524004784236376453347268364152648346245840573214241419937917242918602639810097866942392015404620153818671425739835074851396421139982713640679581178458198658692285968043243656709796000
43466557686937456435688527675040625802564660517371780402481729089536555417949051890403879840079255169295922593080322634775209689623239873322471161642996440906533187938298969649928516003704476137795166849228875
43466557686937456435688527675040625802564660517371780402481729089536555417949051890403879840079255169295922593080322634775209689623239873322471161642996440906533187938298969649928516003704476137795166849228875
4181
-}
{-
BENCHMARK
-}
